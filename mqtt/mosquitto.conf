persistence false
# Disable anonymous access - require authentication
allow_anonymous false
acl_file /mosquitto/config/acls
password_file /mosquitto/config/passwords
log_dest stdout
user root

# Internal listener for API server (within docker network only)
# No TLS - secured by docker network isolation
listener 1883 0.0.0.0

# mTLS listener on port 8883 (for physical player devices)
# Requires valid client certificate signed by our CA
listener 8883 0.0.0.0
cafile /mosquitto/certs/ca.crt
certfile /mosquitto/certs/server.crt
keyfile /mosquitto/certs/server.key
require_certificate true
use_identity_as_username true
tls_version tlsv1.2
# Enable certificate revocation list checking
crlfile /mosquitto/certs/crl.pem

# WebSocket listener on port 9001 (for web clients - password auth)
listener 9001 0.0.0.0
protocol websockets
# WebSocket doesn't use client certs, so we'll use password auth
# Note: This is less secure but necessary for browser compatibility
# In production, consider using proper authentication tokens
